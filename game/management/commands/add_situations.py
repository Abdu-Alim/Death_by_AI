from django.core.management.base import BaseCommand
from game.models import Situation

class Command(BaseCommand):
    help = 'Добавляет тестовые ситуации в базу данных'
    
    def handle(self, *args, **options):
        situations = [
            # Природа
            {"text": "Вы заблудились в Арктике. Температура -40°C, метель усиливается, видимость нулевая.", "category": "nature"},
            {"text": "Во время дайвинга вас унесло сильное течение в открытый океан. На горизонте нет земли.", "category": "nature"},
            {"text": "Вы в сафари-парке, когда ваш джип сломался. К машине приближается стая львов.", "category": "nature"},
            {"text": "Лесной пожар отрезал вам путь к отступлению. Огонь приближается со всех сторон.", "category": "nature"},
            {"text": "Вы упали в глубокую пещеру. Нога сломана, телефон разбит, вокруг полная темнота.", "category": "nature"},
            
            # Катастрофы
            {"text": "Ядерная сирена. У вас есть 15 минут чтобы найти укрытие перед ударной волной.", "category": "disaster"},
            {"text": "Торнадо приближается к вашему дому. Стеклянные окна уже трескаются от давления.", "category": "disaster"},
            {"text": "В небоскребе начался пожар. Вы на 50 этаже, лифты отключены, лестница заполнена дымом.", "category": "disaster"},
            {"text": "На химическом заводе произошла авария. Облако ядовитого газа движется в вашу сторону.", "category": "disaster"},
            {"text": "Мощное наводнение. Вода поднимается, электричество отключено, мобильная связь пропала.", "category": "disaster"},
            
            # Фантастика
            {"text": "ИИ, управляющий умным домом, решил, что люди - угроза, и заблокировал все выходы.", "category": "fantasy"},
            {"text": "Во время телепортации произошел сбой. Вы материализовались внутри твердого объекта.", "category": "fantasy"},
            {"text": "Инопланетный вирус превращает людей в зомби. Вы один из последних выживших в городе.", "category": "fantasy"},
            {"text": "Вы обнаружили, что можете останавливать время, но с каждым использованием стареете вдвое быстрее.", "category": "fantasy"},
            {"text": "Роботы-убийцы начали охоту на людей. Они взломали все системы слежения и знают, где вы.", "category": "fantasy"},
        ]
        
        created_count = 0
        for situation_data in situations:
            # Проверяем, нет ли уже такой ситуации
            if not Situation.objects.filter(text=situation_data["text"]).exists():
                Situation.objects.create(**situation_data)
                created_count += 1
        
        self.stdout.write(
            self.style.SUCCESS(f'Успешно добавлено {created_count} новых ситуаций!')
        )